<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Detalle Producto</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
<header>
  <a href="index.html" class="logo">
    <img src="https://i.postimg.cc/RFr9m6GY/freepik-br-c1e0cdce-9a9e-4d16-a6d9-4dd03ea0907a.png" alt="Logo" />
    <h1>Mi Tienda Retro</h1>
  </a>
</header>

<main id="productDetail" class="product-detail-container">
  <!-- Aquí se carga el detalle vía script -->
</main>

<script>
  const productos = [
    {
      id: "p1",
      name: "Auriculares Bluetooth",
      description: "Auriculares inalámbricos con cancelación de ruido",
      price: 4999,
      oldPrice: 7999,
      images: ["img/auriculares1.jpg", "img/auriculares2.jpg", "img/auriculares3.jpg"],
      mlLink: "https://www.mercadolibre.com.ar/auriculares-bluetooth/p1"
    },
    {
      id: "p2",
      name: "Kit Arduino Uno",
      description: "Kit completo de desarrollo con Arduino Uno R3",
      price: 8999,
      oldPrice: 12999,
      images: ["img/arduino1.jpg", "img/arduino2.jpg", "img/arduino3.jpg"],
      mlLink: "https://www.mercadolibre.com.ar/kit-arduino-unoo/p2"
    },
    {
      id: "p3",
      name: "Teclado Retro Iluminado",
      description: "Teclado mecánico retro con luces RGB",
      price: 12999,
      oldPrice: 17999,
      images: ["img/teclado1.jpg", "img/teclado2.jpg", "img/teclado3.jpg"],
      mlLink: "https://www.mercadolibre.com.ar/teclado-retro/p3"
    }
  ];

  // Obtener ID de URL
  const urlParams = new URLSearchParams(window.location.search);
  const productId = urlParams.get("id");
  const product = productos.find(p => p.id === productId);

  if (!product) {
    document.getElementById("productDetail").innerHTML = "<p>Producto no encontrado.</p>";
  } else {
    let currentImageIndex = 0;

    function showImage(index) {
      currentImageIndex = (index + product.images.length) % product.images.length;
      document.getElementById("mainImage").src = product.images[currentImageIndex];
    }

    function addToCart() {
      let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
      const existing = carrito.find(item => item.id === product.id);
      if (existing) {
        existing.cantidad++;
      } else {
        carrito.push({ id: product.id, cantidad: 1 });
      }
      localStorage.setItem("carrito", JSON.stringify(carrito));
      alert("Producto añadido al carrito.");
    }

    function comprar() {
      window.open(product.mlLink, "_blank");
    }

    document.getElementById("productDetail").innerHTML = `
      <div class="product-images">
        <img id="mainImage" src="${product.images[0]}" alt="${product.name}" />
        <div class="image-thumbnails">
          ${product.images.map((img, i) => `
            <img src="${img}" alt="Imagen ${i+1}" class="thumb" data-index="${i}" />
          `).join("")}
        </div>
      </div>
      <div class="product-info">
        <h2>${product.name}</h2>
        <p><del>$${product.oldPrice}</del> <strong>$${product.price}</strong></p>
        <p>${product.description}</p>
        <div class="buttons-row">
          <button class="buy-btn" id="buyBtn">
            Comprar
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zm10 0c-1.1 0-1.99.9-1.99 2S15.9 22 17 22s2-.9 2-2-.9-2-2-2zM7.16 14h9.69l1.24-5H6.12l1.04 5zM6 6H4v2h2l3.6 7.59-1.35 2.44C7.16 18.37 7 18.68 7 19c0 .55.45 1 1 1h12v-2H9.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.72c.75 0 1.41-.41 1.75-1.03L21.75 7H7.16z"/>
            </svg>
          </button>
          <button id="addCartBtn" class="buy-btn" style="background:#eee;color:#2a2a2a;">
            Añadir al carrito
            <svg xmlns="http://www.w3.org/2000/svg" fill="#2a2a2a" viewBox="0 0 24 24" width="22" height="22">
              <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zm10 0c-1.1 0-1.99.9-1.99 2S15.9 22 17 22s2-.9 2-2-.9-2-2-2zM7.16 14h9.69l1.24-5H6.12l1.04 5zM6 6H4v2h2l3.6 7.59-1.35 2.44C7.16 18.37 7 18.68 7 19c0 .55.45 1 1 1h12v-2H9.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.72c.75 0 1.41-.41 1.75-1.03L21.75 7H7.16z"/>
            </svg>
          </button>
        </div>
      </div>
    `;

    // Eventos imágenes thumbnails
    document.querySelectorAll(".thumb").forEach(thumb => {
      thumb.addEventListener("click", e => {
        showImage(+e.target.dataset.index);
      });
    });

    // Evento comprar
    document.getElementById("buyBtn").addEventListener("click", () => {
      comprar();
    });

    // Evento añadir carrito
    document.getElementById("addCartBtn").addEventListener("click", () => {
      addToCart();
    });
  }
</script>
</body>
</html>
